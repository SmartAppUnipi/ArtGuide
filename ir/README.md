# ArtGuide

### Prerequisites

In order to run this project you will need:
- Node.js
  - [https://nodejs.org/en/download/](https://nodejs.org/en/download/)
- Typescript > 3.7
  - `npm install -g typescript`
- *JavaScript and TypeScript Nightly* Visual Studio Code extension installed. 
  - [https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-typescript-next](https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-typescript-next)
  - To make sure you are using the latest version of *typescript*:
    - Open a TypeScript file in VS Code.
    - In the VS Code command palette (press F1), run the *TypeScript: Select TypeScript version* command.
    - Make sure you have *Use VS Code's version* selected


### Environmental variables
You must create a file called `.env` with that content in order to run the module correctly.
```
GoogleCustomSearchAPIKey_00=AIzaxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-xxxx
# The search engine id for different languages (https://cse.google.com/cse/all) 
GoogleCustomSearchEngineId_EN_00=xxxxxxxxxxxxxxxxxxxxx:xxxxxxxxxxx
GoogleCustomSearchEngineId_IT_00=xxxxxxxxxxxxxxxxxxxxx:xxxxxxxxxxx
```

### How to run
```bash
npm i               # install dependencies
npm start           # start the server in watch mode
```

### Available commands
```bash
npm i               # install dependencies
npm start           # start the server in watch mode

npm run build       # compiles src/*.ts in dist/*.js
npm run watch       # automatically compiles ts when the file is saved

npm t               # run unit tests
npm t -- filename   # run a specific test file
npm run test:watch  # run tests in watch mode (TDD)
npm run test:cov    # run coverage report
npm tun test:debug  # run tests and attach VS Code debugger

npm run lint        # run linter
npm run lint:fix    # run linter with --fix option

npm run docs        # generate the documentation in /docs
```

### Linter

We are using ESLint as linter together with a plugin to make it work properly with TypeScript. The list of our rules can be found in [eslintrc.js](.eslintrc.js). Whenever we use a rule specified in *typescript-eslint-plugin* we need to disable the original *ESLint* rule and override it with the one provided by the plugin.

Useful links:
    - [Available ESLint rules](https://eslint.org/docs/rules)
    - [Available TypeScript rules](https://github.com/typescript-eslint/typescript-eslint/tree/master/packages/eslint-plugin/docs/rules)


## Folder structure
- [assets](assets) contains example json that we use for testing purposes.
- [docs](docs) contains the documentation of each class, automatically generated by TypeScript using the JSdoc.
- [src](src)
  - [models](src/models) contains the TypeScript classes and interfaced used for the exchanged objects.
  - [parser](src/parser) parses url and extracts page content, divides it into sections and extracts keywords using the rake approach.
  - [search](src/parser) builds the queries and performs searches on Google Search.
  - [wiki](src/wiki)
    - [wikidata](src/wiki/wikidata) extract information from WikiData using the entities ID. It's used also to understand if the entity is recognized as a famous piece of art or as a generic class of artwork.
    - [wikipedia](src/wiki/wikipedia) extract results from Wikipedia.
  - [app.ts](src/app.ts) is the server with the main flow.
  - [declarations.ts](src/declarations.ts) contains declarations for non-typescript libraries.
  - [environment.ts](src/environment.ts) parses the .env file.
  - [index.ts](src/index.ts) starts the server.
  - [logger.ts](src/logger.ts) is used to log on file.
  - [utils.ts](src/utils.ts) contains utility functions.
- [tests](tests) divided in [unit](tests/unit) and [integration](tests/integration) tests.
- `/`
  - `.env` contains the environment variables.
  - [config.json](config.json) contains variables and settings used in our app.
  - [*-cache](google-cache.json) contains the cached Google Search results, since we have a limited number of queries each day.
  - The other files are the configurations for Node.js, TypeScript, ESlint, git, etc.